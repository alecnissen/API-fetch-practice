<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fetch-API-Practice</title>
</head>
<body>
    <img src="#"> 

    <button id="fetch-btn">Fetch Img</button>

    <form action="" id="form"> 
        <label for="search">Input your search</label>
        <input type="search" name="search" id="search">
        <input type="submit" id="submit">
        <div id="error"></div>
    </form> 


    <script> 

            let fetchBtn = document.getElementById('fetch-btn'); 

            // let value = ''; 

            let updateValue = {value: ''} 

        let searchFormInputBtn = document.getElementById('submit'); 

        let searchFormInput = document.getElementById('search');

        let searchFormInputField = document.getElementById('search'); 

        // let error = document.getElementById('error'); 

        searchFormInputBtn.addEventListener('click', (e) => { 
            e.preventDefault();  
           // updateValue = document.getElementById('search').value; 
           // console.log(updateValue);
            fetch(`https://api.giphy.com/v1/gifs/translate?api_key=yvY2ZaKIJ3IEtLtzLjasfaje2q6wFIKj&s=${searchFormInput.value}`, {mode: 'cors'})
        .then(function(response) {
            return response.json(); 
        })
        .then(function(response) {
            console.log(response);
         img.src = response.data.images.original.url;
           let errorDiv = document.getElementById('error');
            errorDiv.textContent = '';
    }).catch((error) => { 
         let errorDiv = document.getElementById('error');
         errorDiv.textContent = "404 error";
        // alert('404, img not found');
    })
    })



    const img = document.querySelector('img');

    fetchBtn.addEventListener('click', (e) => { 
        fetch('https://api.giphy.com/v1/gifs/translate?api_key=yvY2ZaKIJ3IEtLtzLjasfaje2q6wFIKj&s=cats', {mode: 'cors'})
        .then(function(response) {
            return response.json(); 
        })
        .then(function(response) {
            console.log(response);
         img.src = response.data.images.original.url;
    }); 
    }) 

//     const img = document.querySelector('img');

//     async function getCats() {
//         const response = await fetch('https://api.giphy.com/v1/gifs/translate?api_key=yvY2ZaKIJ3IEtLtzLjasfaje2q6wFIKj&s=cats', {mode: 'cors'});
//         const catData = await response.json();
//         img.src = catData.data.images.original.url;
// }
//     getCats();

// function loadJson(url) {
//   return fetch(url)
//     .then(response => {
//       if (response.status == 200) {
//         return response.json();
//       } else {
//         throw new Error(response.status);
//       }
//     });
// }

// loadJson('https://javascript.info/no-such-user.json')
//   .catch(alert); 

// async function loadJson(url) {
//     let res = await fetch(url);
//     if (res.status == 200) { 
//         let json = await res.json();
//         return json;
//     }  
//     throw new Error(res.status); 
// }

//  loadJson('https://javascript.info/no-such-user.json')
//    .catch(alert);  

//  Rewrite it using async/await instead of .then/catch.

// And get rid of the recursion in favour of a loop in demoGithubUser: 

// with async/await that becomes easy to do.

// async function wait() {
//   await new Promise(resolve => setTimeout(resolve, 1000));

//   return 10;
// }

// function f() {
//   // shows 10 after 1 second
//   wait().then(result => alert(result));
// }

// f(); 

// function doubleAfter2Seconds(x) {
//   return new Promise(resolve => {
//     setTimeout(() => {
//       resolve(x * 2);
//     }, 2000);
//   });
// } 

// async function addAsync(x) { 
//     const a = await doubleAfter2Seconds(10);
//     const b = await doubleAfter2Seconds(20); 
//     const c = await doubleAfter2Seconds(30); 
//     return x + a + b + c;
// } 

// addAsync(10).then((sum) => { 
//     console.log(sum);
// })

// let pizza 

// function orderPizza() { 
//     console.log('Order Pizza'); 
//     setTimeout(() => { 
//         pizza = 'zza';
//         console.log(`${pizza} is ready`)
//     }, 2000)
//     pizza = 'Pizza'
//     console.log('Pizza was ordered')
// }

// orderPizza(); 
// console.log('Call Qoli')
// console.log(`Eat ${pizza}`) 

// function orderPizza(callback) { 
//     setTimeout(() => { 
//         const pizza = 'zza';
//         callback(pizza); 
//     }, 2000)
// }

// function pizzaReady(pizza) { 
//     console.log(`eat the ${pizza}`)
// }

// orderPizza(pizzaReady);
// console.log(`Call Qoli`); 

// function thing1 (callback) { 
//     callback() 
// }

// function thing2 (callback) {
//     callback()
// } 

// function thing3 (callback) { 
//     callback()
// }

// thing1 

// function getData() { 
//     return new Promise(resolve => { 
//         setTimeout(() => { 
//             resolve(46)
//         }, 1)
//     })
// } 

// async function start() { 
//     const data = await fetch('https://api.weather.gov/gridpoints/OKX/35,35/forecast')
//     const result = await data.json()
//     console.log(result.properties.periods[1].shortForecast)
// } 

// start();  

// function getData() { 
//     return new Promise(function(resolve, reject) {
//         setTimeout(() =>  {
//             reject('Something went wrong!')
//         }, 1)
//     })
// }

// async function start() { 
//     try { 
//         const result = await getData()
//     } catch (error) { 
//         console.log(`ERROR: ${error}`)
//     }
// }

// start(); 


function makeRequest(location) { 
    return new Promise((resolve, reject) => { 
        console.log(`Making Request to ${location}`)
        if (location === 'Google') { 
            resolve('Google says hi')
        } else { 
            reject('We can only talk to Google')
        }
    })
}

function processRequest(response) { 
    return new Promise((resolve, reject) => { 
        console.log('Processing response')
        resolve(`Extra Information + ${response}`)
    })
} 

async function doWork() { 
    try { 
        const response = await makeRequest('Facebook'); 
        console.log('Response Received'); 
        const processedResponse = await processRequest(response)
        console.log(processedResponse);
    } catch (err) { 
        console.log(err)
    }
}

doWork();


// makeRequest('Facebook').then(response => { 
//     console.log('Response Received'); 
//     return processRequest(response); 

// }).then(processedResponse => { 
//     console.log(processedResponse);
// }).catch(err => { 
//     console.log(err);
// }) 
    </script>
</body>
</html>